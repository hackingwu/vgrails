:imagesdir: ./images
:sectnums:


### 领域模型间关系

* 一对一：one-to-one
* 一对多：one-to-many
* 多对多：many-to-many

### 一对一(one-to-one)

[plantuml, relation-one-to-one, png]
----
学生 "1" o-- "1" 学生证 : 拥有
----

对应模型的精简代码如下：
[source,groovy]
----
class StudentCard{
}

class Student{
    ...

    StudentCard     studentCard //<1>

    //约束
    static constraints = {
        ...
        studentCard attributes:[associationType: 'one-to-one'] //<2>
        ...
    }
}

----
<1> 在`学生`对象中声明对`学生证`对象的应用
<2> 定义该关联类型为`one-to-one`, 框架会在自动生成的代码中添加同一学生证不会被多个学生使用的校验

### 一对多(one-to-many)

[plantuml, relation-one-to-many, png]
----
组织 "1" o-- "m" 学生 : 拥有
----

对应模型的精简代码如下：
[source,groovy]
----
class Organization{
}

class Student{
    Organization owner //<1>
    //约束
    static constraints = {
        ...
        owner attributes:[associationType: 'one-to-many'], nullable:true    //<2>
        owner attributes:[locale: "归属组织"], nullable:true    //<3>
        ...
    }
}
----
<1> 在`学生`对象中声明对`组织`对象的应用
<2> 定义该关联类型为`one-to-many`
<3> 如果省略关系类型，框架也会默认推导类型为：`one-to-many`

### 多对多(many-to-many)

[plantuml, relation-many-to-many, png]
----
学生 "m" -- "n" 课程: 选修课程
----

假设业务需求为记录建议选修课程和自由选修课程，对应模型的精简代码如下：
[source,groovy]
----
class Lesson{

    static transients = ['suggestSelectd', 'freeSelectd']   //<1>

    List<Student> suggestSelectd    //<2>
    List<Student> freeSelectd       //<3>

    static constraints = {
         suggestSelectd attributes:[associationType: "many-to-many"]//<4>
         freeSelectd    attributes:[locale: "自由选择"]//<5>
    }
}

class Student{

    static transients = ['suggestSelectd', 'freeSelectd']

    List<Lesson> suggestSelectd
    List<Lesson> freeSelectd

    static constraints = {
        suggestSelectd attributes:[locale: "建议选择"], nullable:true
        freeSelectd    attributes:[locale: "自由选择"], nullable:true
    }
}
----
<1> 在对象中声明多对多属性为transients
<2> 定义属性
<3> 定义属性
<4> 定义约束，并指定类型
<5> 如果省略关系类型，框架也会默认推导类型为：`many-to-many`